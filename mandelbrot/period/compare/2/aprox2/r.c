
#include <stdio.h>
#include <stdlib.h>
#include <math.h>

/*


gcc r.c -lm -Wall
./a.out

approximated  = result
 0 ; 1.000000 ;-0.000000 
 1 ; 2.000000 ;-0.999991 
 2 ; 4.000000 ;-1.310768 
 3 ; 8.000000 ;-1.381428 
 4 ; 16.000000 ;-1.396880 
 5 ; 32.000000 ;-1.400244 
 6 ; 64.000000 ;-1.400977 
 7 ; 128.000000 ;-1.401136 
 8 ; 256.000000 ;-1.401171 
 9 ; 512.000000 ;-1.401178 
 10 ; 1024.000000 ;-1.401180 
 11 ; 2048.000000 ;-1.401180 
 12 ; 4096.000000 ;-1.401180 
 13 ; 8192.000000 ;-1.401180 


expected values : 
1	 0.000000000000000000
2	-1.000000000000000000
4	-1.310702641336832880
8	-1.381547484432061460
16	-1.396945359704561
32	-1.400253081214783  
64	-1.400961962944841  
128	-1.401113804939777  
256	-1.401146325826947  
512	-1.401153290849925 
1024	-1.401154782546620 
2048	-1.401155101040604  
4096	-1.401155101040604  

http://zunzun.com/
*/

// Fitting target: lowest sum of squared absolute error
// Fitting target value = 2.60478044968e-08
double f(double x)
{
double temp;
temp = 0.0;
// coefficients
double a = 1.9215733861373663E-01;
double b = 5.2152682095173475E-01;
double c = 3.2001206979544676E+00;
double Offset = -1.4011803544144721E+00;
temp = x/ (a + b*pow(x, c));
temp += Offset;
return temp;
}



int main()
{


int i;
double p;
double c;

for (i=0; i<14; i++) 
{
  p=pow(2,i);
  c=f(p);
  printf(" %d ; %f ;%f \n", i,p,c);  
}

return 0;
}
